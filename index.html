<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Intake Form</title>
    <style>
        .container {
            max-width: 700px;
            margin: 0 auto;
        }
        .form-section {
            display: none;
        }
        .form-section.active {
            display: block;
        }
        button {
            padding: 10px 15px;
            margin: 5px;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.9/xlsx.full.min.js"></script>
</head>
<body>

<div class="container">
    <form id="projectIntakeForm">

        <!-- Page 1 -->
        <div class="form-section active" id="page1">
            <label for="projectName">Project Name:</label>
            <input type="text" id="projectName" name="projectName" required><br>

            <label for="projectManager">Project Manager:</label>
            <input type="text" id="projectManager" name="projectManager" required><br>

            <label for="projectSponsor">Project Sponsor:</label>
            <input type="text" id="projectSponsor" name="projectSponsor" required><br>

            <label for="projectStartDate">Start Date:</label>
            <input type="date" id="projectStartDate" name="projectStartDate" required><br>

            <label for="projectEndDate">End Date:</label>
            <input type="date" id="projectEndDate" name="projectEndDate" required><br>
        </div>

        <!-- Page 2 -->
        <div class="form-section" id="page2">
            <label for="projectObjective">Project Objective:</label>
            <textarea id="projectObjective" name="projectObjective" required></textarea><br>

            <label for="projectScope">Project Scope:</label>
            <textarea id="projectScope" name="projectScope" required></textarea><br>

            <label for="projectMilestones">Project Milestones:</label>
            <textarea id="projectMilestones" name="projectMilestones" required></textarea><br>
        </div>

        <!-- Page 3 -->
        <div class="form-section" id="page3">
            <label for="estimatedBudget">Estimated Budget:</label>
            <input type="number" id="estimatedBudget" name="estimatedBudget" required><br>

            <label for="actualCost">Actual Cost:</label>
            <input type="number" id="actualCost" name="actualCost" required><br>

            <label for="resourcesNeeded">Resources Needed:</label>
            <textarea id="resourcesNeeded" name="resourcesNeeded" required></textarea><br>
        </div>

        <div class="navigation-buttons">
            <button type="button" id="prevBtn" onclick="navigate(-1)">Previous</button>
            <button type="button" id="nextBtn" onclick="navigate(1)">Next</button>
            <button type="button" id="submitBtn" onclick="generateExcel()">Submit & Generate Excel</button>
        </div>
        
    </form>
</div>

<script>
    var currentTab = 0;
    document.getElementById('submitBtn').style.display = 'none';
    showTab(currentTab);

    function showTab(n) {
        var x = document.getElementsByClassName("form-section");
        x[n].style.display = "block";
        if (n == 0) {
            document.getElementById('prevBtn').style.display = "none";
        } else {
            document.getElementById('prevBtn').style.display = "inline";
        }
        if (n == (x.length - 1)) {
            document.getElementById('nextBtn').style.display = "none";
            document.getElementById('submitBtn').style.display = "inline";
        } else {
            document.getElementById('nextBtn').style.display = "inline";
            document.getElementById('submitBtn').style.display = "none";
        }
    }

    function navigate(n) {
        var x = document.getElementsByClassName("form-section");
        x[currentTab].style.display = "none";
        currentTab = currentTab + n;
        if (currentTab >= x.length) {
            currentTab = x.length - 1;
        }
        if (currentTab < 0) {
            currentTab = 0;
        }
        showTab(currentTab);
    }

    function generateExcel() {
        // Collect data from form...
        var formElements = document.getElementById('projectIntakeForm').elements;
        var formData = {};
        for (var i = 0; i < formElements.length; i++) {
            if (formElements[i].type !== "button") {
                formData[formElements[i].name] = formElements[i].value;
            }
        }

        // Use the form data to generate an Excel file...
        var wb = XLSX.utils.book_new();
        wb.Props = {
            Title: "Project Intake Form",
            Subject: "Form Data",
            Author: "Project Management Office",
            CreatedDate: new Date()
        };

        wb.SheetNames.push("Project Details");
        var ws_data = [
            // ... You will fill this part with your actual form data structure ...
        ];
        // Use formData to fill in the data
        for (var key in formData) {
            if (formData.hasOwnProperty(key)) {
                ws_data.push([key, formData[key]]);
            }
        }

        var ws = XLSX.utils.aoa_to_sheet(ws_data);
        XLSX.utils.book_append_sheet(wb, ws, "Project Details");
        XLSX.writeFile(wb, "ProjectIntakeForm.xlsx");
    }
</script>

</body>
</html>
